!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/index.js")}({"./src/index.js":function(e,t,n){"use strict";n.r(t);const i=document.getElementById("canvas"),r=i.getContext("webgl",{antialias:!0,powerPreference:"high-performance"}),o={vertex:"precision highp float;\r\n\r\nattribute vec4 aVertexPosition;\r\nattribute mediump vec2 aTexturePosition;\r\n\r\nuniform mat4 uMatrix;\r\n\r\nvarying mediump vec2 texCoord;\r\n\r\nvoid main() {\r\n  texCoord = aTexturePosition;\r\n  gl_Position = uMatrix * aVertexPosition;\r\n}\r\n",frag:"precision mediump float;\r\n\r\nuniform sampler2D uSampler;\r\nuniform lowp float uAlpha;\r\n\r\nvarying vec2 texCoord;\r\n\r\nvoid main() {\r\n  vec4 result = texture2D(uSampler, texCoord);\r\n\r\n  if (result.a < 0.1) {\r\n    discard;\r\n  }\r\n\r\n  gl_FragColor = result;\r\n}\r\n"};{const e=r.getExtension("OES_vertex_array_object");r.createVertexArray=function(){return e.createVertexArrayOES()},r.bindVertexArray=function(t){return e.bindVertexArrayOES(t)}}const a=1e-6;function s(){const e=new Float32Array(16);return e[0]=e[5]=e[10]=e[15]=1,e}function c(e){return e[0]=e[5]=e[10]=e[15]=1,e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e}function u(e,t,n){const i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],c=e[5],u=e[6],d=e[7],l=e[8],f=e[9],h=e[10],m=e[11],p=e[12],E=e[13],g=e[14],x=e[15];let T=0,v=0,y=0,A=0;return T=t[0],v=t[1],y=t[2],A=t[3],n[0]=T*i+v*s+y*l+A*p,n[1]=T*r+v*c+y*f+A*E,n[2]=T*o+v*u+y*h+A*g,n[3]=T*a+v*d+y*m+A*x,T=t[4],v=t[5],y=t[6],A=t[7],n[4]=T*i+v*s+y*l+A*p,n[5]=T*r+v*c+y*f+A*E,n[6]=T*o+v*u+y*h+A*g,n[7]=T*a+v*d+y*m+A*x,T=t[8],v=t[9],y=t[10],A=t[11],n[8]=T*i+v*s+y*l+A*p,n[9]=T*r+v*c+y*f+A*E,n[10]=T*o+v*u+y*h+A*g,n[11]=T*a+v*d+y*m+A*x,T=t[12],v=t[13],y=t[14],A=t[15],n[12]=T*i+v*s+y*l+A*p,n[13]=T*r+v*c+y*f+A*E,n[14]=T*o+v*u+y*h+A*g,n[15]=T*a+v*d+y*m+A*x,n}function d(e,t,n,i){e[12]=e[0]*t+e[4]*n+e[8]*i+e[12],e[13]=e[1]*t+e[5]*n+e[9]*i+e[13],e[14]=e[2]*t+e[6]*n+e[10]*i+e[14],e[15]=e[3]*t+e[7]*n+e[11]*i+e[15]}function l(e,t,n,i,r){let o=Math.sqrt(n*n+i*i+r*r);if(o<a)throw new Error("m4_rotate(): matrix length is zero");const s=n*(o=1/o),c=i*o,u=r*o,d=Math.sin(t),l=Math.cos(t),f=1-l,h=e[0],m=e[1],p=e[2],E=e[3],g=e[4],x=e[5],T=e[6],v=e[7],y=e[8],A=e[9],w=e[10],S=e[11],_=s*s*f+l,R=c*s*f+u*d,O=u*s*f-c*d,b=s*c*f-u*d,L=c*c*f+l,I=u*c*f+s*d,U=s*u*f+c*d,M=c*u*f-s*d,D=u*u*f+l;e[0]=h*_+g*R+y*O,e[1]=m*_+x*R+A*O,e[2]=p*_+T*R+w*O,e[3]=E*_+v*R+S*O,e[4]=h*b+g*L+y*I,e[5]=m*b+x*L+A*I,e[6]=p*b+T*L+w*I,e[7]=E*b+v*L+S*I,e[8]=h*U+g*M+y*D,e[9]=m*U+x*M+A*D,e[10]=p*U+T*M+w*D,e[11]=E*U+v*M+S*D}function f(){const e=r.canvas,t=window.devicePixelRatio,n=e.clientWidth*t|0,i=e.clientHeight*t|0;e.width===n&&e.height===i||(e.width=n,e.height=i,g=e.clientWidth/e.clientHeight,E=function(e,t,n,i){const r=new Float32Array(16),o=1/Math.tan(e/2),a=1/(n-i);return r[0]=o/t,r[5]=o,r[10]=(i+n)*a,r[11]=-1,r[14]=2*i*n*a,r}(h,g,m,p),r.viewport(0,0,e.width,e.height))}const h=30*Math.PI/180;const m=10,p=5e3;let E,g=0;function x(e,t){const n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS))return n;console.error("Error compiling shader: ",r.getShaderInfoLog(n)),r.deleteShader(n)}i.addEventListener("webglcontextlost",function(e){e.preventDefault()},!1),i.addEventListener("webglcontextrestored",function(e){},!1),f(),addEventListener("resize",f,{passive:!0}),r.clearColor(0,0,0,0),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.depthMask(!0),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.CULL_FACE),r.cullFace(r.FRONT);const T=function(e,t,n,i){const o=r.createProgram();if(r.attachShader(o,e),r.attachShader(o,t),void 0!==n)for(let e=0;e<n.length;e++)r.bindAttribLocation(o,void 0!==i?i[e]:e,n[e]);if(r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS))return o;r.deleteProgram(o)}(x(r.VERTEX_SHADER,o.vertex),x(r.FRAGMENT_SHADER,o.frag)),v={uMatrix:r.getUniformLocation(T,"uMatrix"),uAlpha:r.getUniformLocation(T,"uAlpha"),uSampler:r.getUniformLocation(T,"uSampler")};function y(e,t,n){const i=r.createVertexArray();r.bindVertexArray(i),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,r.createBuffer()),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW);for(let e,t,i=0,o=n.length;i<o;i++)e=n[i],t=r.getAttribLocation(T,e.name),r.bindBuffer(r.ARRAY_BUFFER,r.createBuffer()),r.bufferData(r.ARRAY_BUFFER,e.data,r.STATIC_DRAW),r.vertexAttribPointer(t,e.size,r.FLOAT,!1,0,0),r.enableVertexAttribArray(t);return r.bindVertexArray(null),i}let A=s(),w=s(),S=100,_=0,R=800,O=0,b=!1,L=1e-5,I=0,U=0,M=0,D=0;function H(e,t){L=e,I=t}function N(e){var t;U+=.01,b&&(S+=(_-S)*(t=O/R,1+--t*t*t*t*t),(O+=1)===R-1&&(b=!1)),D+=Math.sin(U*I)*L,M+=Math.sin(U*I)*L,c(A),l(A,-M,1,0,0),l(A,-D,0,1,0),d(A,-e,-24,-2*S),u(E,A,w)}function P(e){const t=e.matrix,n=e.translation,i=e.rotation,r=e.scale;c(e.matrix),d(t,n.x,n.y,n.z),0!==i.x&&l(t,i.x,1,0,0),0!==i.y&&l(t,i.y,0,1,0),0!==i.z&&l(t,i.z,0,0,1),function(e,t,n,i){e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=n,e[5]*=n,e[6]*=n,e[7]*=n,e[8]*=i,e[9]*=i,e[10]*=i,e[11]*=i}(t,r.x,r.y,r.z)}function F(e){const t=e.translation,n=e.velocity;t.x+=n.x,t.y+=n.y,t.z+=n.z;const i=e.rotation,r=e.angularVelocity;i.x+=r.x,i.y+=r.y,i.z+=r.z;const o=e.scale,a=e.scaleVelocity;o.x+=a.x,o.y+=a.y,o.z+=a.z}let B=-1;const C=[],V=[],z=new Uint8Array([0,0,0,0]);function G(e){const t=e.target;if(!Y(t.width)||!Y(t.height))throw new Error(`${t.src} is not power of 2`);const n=+t.id;r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,V[n]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.generateMipmap(r.TEXTURE_2D)}function Y(e){return 0==(e&e-1)}function W(e){0}function k(e){const t=C.indexOf(e);if(t>-1)return t;const n=V.length,i=r.createTexture();r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,i),V.push(i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,z);const o=new Image;return o.id=n,o.onload=G,o.onerror=W,o.src=e,C.push(e),n}const X=new Float32Array([-1,1,1,1,-1,-1,1,-1]),j=new Uint16Array([3,2,0,3,0,1]);function $(e,t,n,i=1,r,o){const a=t/2,c=n/2,u=new Float32Array(X),d=[];for(let e=0;e<u.length;e+=2)u[e+0]*=a,u[e+1]*=c;const l=o.width,f=o.height,h=o.frameWidth/l,m=o.frameHeight/f,p=l/o.frameWidth;for(let e=0,t=0,n=0;n<i;n++){e=n*h%p,t=(n/p|0)*m;const i=new Float32Array([e+0+.001,t+0+.001,e+h-.001,t+0+.001,e+0+.001,t+m-.001,e+h-.001,t+m-.001]);d.push(y(0,j,[{name:"aVertexPosition",data:u,size:2},{name:"aTexturePosition",data:i,size:2}]))}const E={...{id:++B,static:!0,physics:!1,collision:!1,box:{w:0,d:0,h:0},translation:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},velocity:{x:0,y:0,z:0},angularVelocity:{x:0,y:0,z:0},scaleVelocity:{x:0,y:0,z:0},matrix:s()},animations:r,sprite:!0,animating:!1,currentAnimation:void 0!==r?r.idle:void 0,vaos:d,vao:d[0],numIndices:j.length,textureId:k(`./sprites/sheets/${e}.png`),step:0,lastStepTime:0};return E.box.w=t,E.box.h=n,E.box.d=1,E.translation.y=c,P(E),E}function K(e,t){e.currentAnimation=e.animations[t],e.step=e.currentAnimation.start,e.vao=e.vaos[e.step]}function J(e,t){const n=e.currentAnimation;if(void 0!==n&&(e.lastStepTime+=t,!(e.lastStepTime<=n.speed||e.step===n.start&&!1===e.animating))){if(e.lastStepTime=0,!1===e.animating||e.step===n.end){if("forwards"===n.fillMode)return;e.step=n.start}else e.step+=1;e.vao=e.vaos[e.step]}}const q=1,Q=2,Z=3,ee=4,te=5,ne=6,ie=7,re=8,oe=9,ae=10;document.querySelector("#input");const se=0,ce=1,ue=2,de=3,le=4,fe=5,he=6,me=7,pe=2,Ee=new Map;let ge,xe;Ee.set(1285,-1),Ee.set(142,le),Ee.set(-142,fe),Ee.set(-428,he),Ee.set(-714,me),Ee.set(428,de),Ee.set(-1e3,se),Ee.set(1e3,ce),Ee.set(714,ue);const Te=[q,Q,Z,ee];const ve=[],ye={87:q,83:ee,65:Q,68:Z,38:re,40:oe,37:ne,39:ie,16:te,32:ae};window.addEventListener("keydown",function(e){const t=ye[e.keyCode];void 0!==t&&ve.push(t)},{passive:!0}),window.addEventListener("keyup",function(e){const t=ye[e.keyCode];void 0!==t&&ve.splice(ve.indexOf(t),1)},{passive:!0});let Ae=-1,we=-1,Se=-1,_e=-1,Re=-1,Oe=-1,be=-1;function Le(){for(Ae=we=Re=Oe=Se=_e=-1;ve.length>0;)ve.pop()}be=setInterval(function(){if(Se===Re&&_e===Oe)for(Ae=Se,we=_e;ve.length>0;)ve.pop();const e=Re-Ae,t=Oe-we;if(Math.abs(e)>Math.abs(t))if(e>0){if(ve.indexOf(ie)>-1)return;ve.push(ie)}else{if(ve.indexOf(ne)>-1)return;ve.push(ne)}else if(t>0){if(ve.indexOf(re)>-1)return;ve.push(re)}else{if(ve.indexOf(oe)>-1)return;ve.push(oe)}console.log(ve.map(function(e){return ne?"punch left":ie?"punch right":re?"punch up":oe?"punch down":void 0}))},25),window.addEventListener("touchstart",function(e){const t=e.touches[0];Ae=Re=t.pageX,we=Oe=t.pageY},{passive:!0}),window.addEventListener("touchmove",function(e){const t=e.touches[0];Se=Re,_e=Oe,Re=t.pageX,Oe=t.pageY},{passive:!0}),window.addEventListener("touchend",Le,{passive:!0}),window.addEventListener("touchcancel",Le,{passive:!0});const Ie=0,Ue=1;let Me=-1,De=-1;function He(e){const t=navigator.getGamepads();De===Ie?function(e,t){for(;t.length>0;)t.pop();for(let t,n=0,i=e.length;n<i;n++)null!==(t=e[n])&&(-1!==t.id.indexOf("Joy-Con (L)")?ge=t:-1!==t.id.indexOf("Joy-Con (R)")&&(xe=t));const n=Ee.get(1e3*ge.axes[9]|0),i=[xe,ge];for(let e,n=0;n<i.length;n++)if(void 0!==(e=i[n]))for(let i,r=0;r<e.buttons.length;r++)if(e.buttons[r].pressed)switch(i=15*n+r+n){case pe:t.push(te)}switch(n){case se:t.push(Z);break;case ce:t.push(q,Z);break;case ue:t.push(q);break;case de:t.push(q,Q);break;case le:t.push(Q);break;case fe:t.push(ee,Q);break;case he:t.push(ee);break;case me:t.push(ee,Z)}}(t,ve):De===Ue&&function(e,t){const[n,i,r,o]=e[0].axes;for(let e,n=0,i=Te.length;n<i;n++)-1!==(e=t.indexOf(Te[n]))&&t.splice(e,1);n>.15?t.push(Z):n<-.15&&t.push(Q),i>.15?t.push(ee):i<-.15&&t.push(q)}(t,ve)}window.addEventListener("gamepadconnected",function(e){if(-1!==Me)return;const t=e.gamepad.id;t.indexOf("Joy-Con")>-1?De=Ie:t.indexOf("Xbox")>-1&&(De=Ue),Me=setInterval(He,1e3/30)},{passive:!0}),window.addEventListener("gamepaddisconnected",function(e){for(;ve.length>0;)ve.pop();clearInterval(Me),Me=-1},{passive:!0});const Ne=1.6,Pe=3,Fe=300,Be={...$("dad",32,32,20,{idle_right:{start:0,end:0,speed:2e3},idle_left:{start:1,end:1,speed:2e3},run_left:{start:2,end:8,speed:80},run_right:{start:9,end:15,speed:80},punch_right:{start:16,end:17,speed:Fe},punch_left:{start:18,end:19,speed:Fe}},{width:256,height:128,frameWidth:32,frameHeight:32}),speed:Ne,static:!1,physics:!0,animating:!0,punching:!1,control:!0,direction:1};Be.translation.z=.6;let Ce=0,Ve=0,ze=0,Ge=0;function Ye(e,t){console.log(e,t),e>0?(K(Be,"run_right"),Be.direction=1):e<0?(K(Be,"run_left"),Be.direction=-1):t>0?(K(Be,"idle_right"),Be.direction=1):t<0&&(K(Be,"idle_left"),Be.direction=-1)}window.addEventListener("blur",function(){Be.velocity.x=0},{passive:!0});const We=document.getElementById("inspiration"),ke=document.getElementById("bottomtext"),Xe=["HOME IS WHERE YOUR FIST IS.","YOU'VE NEVER FELT SO ALIVE.","HOME IS THE NICEST WORD THERE IS.","YOU WONDER WHAT'S FOR DINNER.","FOLLOW YOUR BLISS.","WE ARE WHO WE ARE.","HOME IS NOT A PLACE. IT'S A FEELING.","JUST GO WITH THE FLOW.","IT'S PAST THEIR BEDTIME.","THERE'S NO PLACE LIKE HOME.","AGE IS JUST A NUMBER.","WE'LL ALL BE LAUGHING ABOUT THIS SOON.","DON'T FORGET TO PAY THE MORTGAGE.","THINGS COULD BE WORSE.","TAKE LEMONS AND MAKE LEMONADE.","YOU'LL REGRET THE THINGS YOU DIDN'T DO.","THE AZALEAS NEED TO BE WATERED.","WORK HARD, PLAY HARD.","GOTTA FIX THAT CREAKY FLOORBOARD.","SOMETIMES YOU JUST GOTTA EAT THE HAM SANDWICH.","REX IS DUE FOR A CHECKUP."],je=[],$e=Xe.length;let Ke=-1,Je=-1;function qe(){for(let e=0,t=$e;e<t;e++)je.push(e);!function(e){for(let t,n,i=e.length-1;i>0;--i)t=Math.floor(Math.random()*(i+1)),n=e[i],e[i]=e[t],e[t]=n}(je)}function Qe(){0===je.length&&qe(),We.innerText=Xe[je.pop()],Je=setTimeout(function(){We.innerText=""},7e3)}function Ze(e,t){We.innerText=e||"",ke.innerText=t||""}const et=document.getElementById("furylevel-container"),tt=document.getElementById("furylevel").style,nt=et.style,it=.0011,rt=.0025;let ot=1,at=!1;function st(e){at=e,e?(et.classList.add("animating","shown"),setTimeout(function(){et.classList.remove("animating")},400)):(et.classList.add("animating"),et.classList.remove("shown"))}const ct=[],ut={};let dt;function lt(e,t,n){e.source=dt.createBufferSource(),e.source.buffer=e.buffer,e.source.loop=t||!1,e.source.connect(e.gainNode),e.gainNode.gain.value=n,e.source.start(1)}function ft(e){return e.arrayBuffer()}function ht(e,t){fetch(t).then(ft).then(function(t){dt.decodeAudioData(t,function(t){ct[e]=function(e){const t=dt.createGain();return t.connect(dt.destination),{source:void 0,buffer:e,gainNode:t}}(t),void 0!==ut[e]&&(lt(ct[e],ut[e].loop,ut[e].vol),delete ut[e])})})}function mt(e,t,n){void 0!==ct[e]?lt(ct[e],t,n):ut[e]={loop:t,vol:n}}function pt(e,t,n){const i=ct[e];void 0!==i&&void 0!==i.source&&i.source.stop(0)}let Et=0,gt=.1;const xt=1.8,Tt=144,vt=.8,yt=!1,At=[{name:"tall_punk",frames:6},{name:"beer_bong",frames:6},{name:"yoga_gal",frames:6},{name:"slice",frames:6},{name:"hover_bro",frames:6}],wt=[{name:"bg_bookshelf",frames:2},{name:"bg_couch",frames:1},{name:"bg_lamp",frames:2},{name:"bg_plant",frames:1},{name:"bg_wallpaper",frames:1}],St=[Be],_t=[];let Rt,Ot=!1,bt=0,Lt=0,It=0,Ut=!1,Mt=!1,Dt=!1,Ht=!1;function Nt(e){const t=St.indexOf(e);t>-1&&St.splice(t,1)}function Pt(e){const t=Math.random()*wt.length-1|0,n=Math.random()*wt.length-1|0,i=Math.random()*wt.length-1|0,r=Bt(wt[t],Et),o=Bt(wt[n],Et+48),a=Bt(wt[i],Et+48+48);if(Et+=Tt,St.push(r,o,a),e){const e=Vt(At[0],Tt/2);_t.push(e),St.push(e)}for(let e,t=0;t<At.length;t++){e=32+Math.random()*(Tt-32)+Et;const n=Vt(At[t],e);_t.push(n),St.push(n)}}function Ft(e,t,n,i,r){const o={...$(e,t,n,1,void 0,r),static:!0};return o.translation.x=t/2+i,o.translation.z=-.1,P(o),o}function Bt(e,t){const n={...$(e.name,48,48,e.frames,{idle:{start:0,end:e.frames-1,speed:200}},{width:64*e.frames,height:64,frameWidth:48,frameHeight:48}),static:frames>1};return n.translation.x=24+t,P(n),n}function Ct(e){e.animating=!0}function Vt(e,t){const n={...$(e.name,32,32,e.frames,{idle:{start:0,end:1,speed:400},fly:{start:2,end:2,speed:400}},{width:128,height:64,frameWidth:32,frameHeight:32}),dead:!1,timeDead:0,static:!1};return setTimeout(Ct,3e3*Math.random(),n),n.translation.z=(.5===gt?gt=.1:gt+=.1,gt),n.translation.x=t||0,P(n),n}function zt(e,t){setTimeout(Gt,1e3*e,t)}function Gt(e){void 0!==e.text&&(Ze(e.text,e.text2),void 0!==e.dur&&setTimeout(Yt,1e3*e.dur)),void 0!==e.control&&(Be.control=e.control),void 0!==e.fn&&e.fn()}function Yt(){Ze("")}function Wt(e=vt){mt(`hit_${5*Math.random()|0}`,!1,e)}function kt(){Ze(""),mt("party",!0,vt),Be.control=!0,Be.velocity.x=1.6,K(Be,"run_right"),Dt=!0}function Xt(){st(!0),zt(4,{dur:3,text:"MAINTAIN YOUR PARENTAL FURY."}),zt(8,{fn:function(){Ke=setInterval(Qe,1e4)}})}function jt(){pt("party"),mt("fail",!0,vt),r.canvas.classList.add("game-over"),Be.velocity.x=0,K(Be,"idle_right"),clearTimeout(Ke),clearTimeout(Je),We.innerText="",st(!1),R=1500||800,_=180,O=0,b=!0,H(0,0),zt(2,{text:`YOU VANQUISHED ${It} PARTYGOERS`}),zt(4,{text:`YOU VANQUISHED ${It} PARTYGOERS`,text2:"BEFORE YOU LOST YOUR PASSION"}),zt(4,{fn:function(){function e(){location.reload(!1)}document.addEventListener("touchstart",e),document.addEventListener("keydown",e),document.addEventListener("click",e)}})}function $t(e){const{x:t}=Be.translation;if(N(t+20),!Ut&&(function(e){if(Ge+=e,!((ze+=e)<40)&&(ze=0,Ce=0,!1!==Be.control)){ve.indexOf(te)>-1?Be.speed=Pe:Be.speed=Ne;for(let e=0,t=ve.length;e<t;e++)switch(ve[e]){case Q:Ce=-Be.speed;break;case Z:Ce=Be.speed}for(let e=0,t=ve.length;e<t;e++)switch(ve[e]){case ae:if(Be.punching)break;return Be.punching=!0,void K(Be,Be.direction>0?"punch_right":"punch_left")}Be.punching&&Ge>Fe&&(Be.punching=!1,Ye(Be.velocity.x,Ve)),Ve!==Ce&&(Ye(Ce,Ve),Be.velocity.x=Ce),Ve=Ce}}(e),!Mt&&t>Et&&(pt("intro"),mt("crowd",!0,vt-.4<0?0:vt-.4),Ze(""),window.nightsky.style.display="none",Nt(Rt),Pt(!0),Pt(),setTimeout(function(){Be.velocity.x=0,K(Be,"idle_right")},200),Be.control=!1,Mt=!0,zt(2.5,{dur:2.5,text:'"Sup bro?"'}),zt(6,{dur:2.5,text:"..."}),zt(9,{dur:2.5,text:'"Aren\'t you a little old for this party?"'}),zt(12,{text:"PUNCH.",fn:Wt}),zt(12.5,{text:"PUNCH. THIS.",fn:Wt}),zt(13,{text:"PUNCH. THIS. GUY.",fn:Wt}),zt(13.5,{dur:.5,text:"PUNCH. THIS. GUY. [spacebar]",fn:Wt}),setTimeout(kt,14e3)),Dt)){Lt=0,t+window.innerWidth>Et&&Pt();for(let t,n=0,i=_t.length;n<i;n++)void 0!==(t=_t[n])&&t.dead&&(t.timeDead+=e,t.timeDead>2e3&&(_t.splice(n,1),Nt(t)));if(Be.punching){Lt=1,Ot||(H(.001,100),Ot=!0);const e=Be.velocity.x>0?xt:-xt;for(let n,i=0,r=_t.length;i<r;i++)(n=_t[i]).dead||Math.abs(t-n.translation.x)<10&&(K(n,"fly"),n.velocity.x=2*e,1===bt?(n.velocity.y=.4,n.angularVelocity.z=.25):2==bt?(n.velocity.y=1,n.angularVelocity.z=.4,n.scaleVelocity.x=n.scaleVelocity.y=n.scaleVelocity.z=.01):3===bt&&(n.velocity.x=3*e,n.velocity.y=1.5,n.angularVelocity.z=.6,n.scaleVelocity.x=n.scaleVelocity.y=n.scaleVelocity.z=.09),Ht||(Ht=!0,Xt()),n.dead=!0,n.physics=!0,It++,1===++bt&&mt(`hit_${5*Math.random|0}`,!1,vt))}else Ot&&(H(1e-5,0),Ot=!1),bt=0;1===Lt&&0===bt&&(bt=-1),function(e){if(!at)return 1;ot-=-1===e?10*it:it,(ot+=rt*(0===e?0:2===e?3:3===e?6:e>=4?9:1))>1&&(ot=1),Math.random(),Math.random();const t=10*(1-ot)*Math.random(),n=10*(1-ot)*Math.random();return nt.transform=`translate(${t}px, ${n}px)`,tt.transform=`scale(${ot}, 1)`,ot}(bt)<=0&&(Ut=!0,jt())}}let Kt,Jt=0,qt=performance.now(),Qt=-1,Zt=!0,en=s(),tn=0,nn=0;function rn(e){r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),Jt=e-qt,qt=e,$t(Jt),function(e){for(tn=0,nn=e.length;tn<nn;tn++)!1===(Kt=e[tn]).static&&(P(Kt),!0===Kt.physics&&F(Kt),J(Kt,Jt)),u(w,Kt.matrix,en),t=Kt.textureId,n=v.uSampler,r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,V[t]),r.uniform1i(n,t),r.bindVertexArray(Kt.vao),r.uniformMatrix4fv(v.uMatrix,!1,en),r.drawElements(r.TRIANGLES,Kt.numIndices,r.UNSIGNED_SHORT,0);var t,n}(St),Qt=window.requestAnimationFrame(rn)}function on(){Zt=!1,Qt=window.requestAnimationFrame(rn)}r.useProgram(T),r.uniform1f(v.uAlpha,1),document.addEventListener("touchstart",function e(){const t=window.AudioContext||window.webkitAudioContext;n=new t,dt=n;var n;ht("intro","./music/intro.mp3");ht("party","./music/party_1.mp3");ht("fail","./music/fail.mp3");ht("hit_0","./music/hit_1.wav");ht("hit_1","./music/hit_2.wav");ht("hit_2","./music/hit_3.wav");ht("hit_3","./music/hit_4.wav");ht("hit_4","./music/hit_5.wav");ht("coin","./music/coin.wav");ht("crowd","./music/crowd.wav");document.removeEventListener("touchstart",e)}),on(),Be.control=yt,Be.translation.x=-80,mt("intro",!0,vt),St.push(Ft("car",96,48,-180,{width:64,height:32,frameWidth:64,frameHeight:32})),Rt=Ft("home",128,128,-20,{width:64,height:64,frameWidth:64,frameHeight:64}),St.push(Rt),zt(3,{dur:3,text:'"I\'m glad I cancelled that trip to Milwaukee."'}),zt(7.5,{dur:3,text:'"...and didn\'t tell the kids."'}),zt(12,{dur:3,text:'"They\'ll be so delighted and surprised."'}),zt(16.5,{dur:3,text:"<- A D ->",control:!0,fn:function(){K(Be,"run_right"),Be.velocity.x=1.6}});let an=Zt;document.addEventListener("visibilitychange",function(){document.hidden?(an=Zt,Zt=!0,window.cancelAnimationFrame(Qt)):!1===an&&on()},{passive:!0,capture:!1})}});